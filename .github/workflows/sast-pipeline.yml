name: SAST pipeline Scan

on:
    push:
        branches:
            - main

jobs:
    semgrep-scan:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v2

            - name: Setup Semgrep
              run: |
                curl -sSL https://github.com/returntocorp/semgrep/releases/download/v1.0.0/semgrep-linux-amd64-v1.0.0.tar.gz | tar xz
                sudo mv semgrep /usr/local/bin/

            - name: Run SAST Semgrep scan
              run: |
                semgrep --config p/ci --output semgrep-result.json --json

            - name: Upload scan results as artifacts
              uses: actions/upload-artifact@v4
              with:
                name: semgrep-result
                path: semgrep-result.json --json


